# Running MesKit on acral melanoma samples from Brazil

## Overview

This repository contains the code that was used to compare the patient and PDX-derived samples in terms of their somatic variants and copy number alteration (CNA) events.

## Repository structure

```bash
.
├── data
│   ├── copy_number
│   │   ├── combined_Human+PDX_with_1st+AltModels_segments_for_meskit.tsv
│   │   ├── ploidy_table_jan2025_data.tsv
│   │   └── segments
│   └── variants
│       ├── 6633_2729_3248-filtered_mutations_matched_allTum_keep_adjusted_for_meskit.maf
│       ├── 6633_2729_3248-filtered_mutations_matched_allTum_keep_clinical_for_meskit.tsv
│       └── 6633_2729_3248-filtered_mutations_matched_allTum_keep.maf
├── metadata
│   └── 6633_METADATA_table.tsv
├── README.md
├── renv.lock
├── results
│   ├── copy_number
│   │   ├── PD53330
│   │   ├── PD53332
│   │   ├── PD53333
│   │   ├── PD53337
│   │   ├── PD53343
│   │   ├── PD53347
│   │   ├── PD53349
│   │   ├── PD53350
│   │   ├── PD53352
│   │   ├── PD53355
│   │   ├── PD53357
│   │   ├── PD53359
│   │   └── PD53364
│   └── variants
│       ├── patient_vs_x1.csv
│       ├── PD53330
│       ├── PD53332
│       ├── PD53333
│       ├── PD53337
│       ├── PD53343_(A)
│       ├── PD53343_(B)
│       ├── PD53347
│       ├── PD53349_(A)
│       ├── PD53349_(B)
│       ├── PD53350_(A)
│       ├── PD53350_(B)
│       ├── PD53352_(A)
│       ├── PD53352_(B)
│       ├── PD53357
│       ├── PD53359
│       ├── PD53364
│       └── README.md
└── src
    ├── copy_number
    │   ├── 01-prepare_sequenza_for_meskit.R
    │   └── 02-make_cna_heatmaps.R
    └── variants
        ├── 01-adjust_maf_for_meskit.sh
        ├── 02-make_trees.R
        └── 03-compare_patient_and_x1.R
```

### Data

The `data/` directory contains most of the input files that are required to run the scripts in this repository, including somatic variant calls generated by CaVEMan/cgpPindel and segments output by Sequenza. 

#### Copy number data

Specifically, `data/copy_number/` contains the Sequenza segments under the subdirectory `segments/`

## Required software and environment

The following software is required to run the analysis:

- R (version 4.2.2)
- R packages:
    - `MesKit`
    - `here`
    - `ggpubr`
    - `dplyr`
    - `tidyr`
    - `stringr`
    - `logger`
    - `readr`
    - `fs`

The required packages can be installed using:
```R
install.packages(c("MesKit", "here", "ggpubr", "dplyr", "tidyr", "stringr", "logger", "readr", "fs"))
```

If you are interested in reproducing the R environment for the code used in R 4.2.2, an `renv.lock` file is available in this repository. To rebuild the environment, run the following inside R:
```R
# Install renv if needed
if (!require("renv")) install.packages("renv")

# Restore the project environment
renv::restore()
```

## Contact

If you have any questions or comments about this repository, please contact:

- Jacqueline Boccacino (<jb62@sanger.ac.uk>)
- Martin del Castillo Velasco-Herrera (<mdc1@sanger.ac.uk>)